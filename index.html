<!DOCTYPE html>
<html>
<head><link rel="stylesheet" type="text/css" href="lib/styles.css"></head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<title>Assignment 3 Testing Centre</title>
<body>
    <div>
        <div>
            <h3>Time Curve Visualization</h3>
            <label>Plot 1 Variable</label>
            <input id="plot1" type="radio" name="enable" checked onclick="updateplot1()">
            <select name="plot1_list" id="plot1_list" onchange="updateData(value)">
                <option value="1">Select 1 Variable</option>
            </select>
        </div>
        <div>
            <label>Plot 2 Variables</label>
            <input id="plot2" type="radio" name="enable"  onclick="updateplot2()">
            <select name="plot2_list1" id="plot2_list1" onchange="updateData(value)">
                <option value="1">Select 2 Variables</option>
            </select>
            <select name="plot2_list2" id="plot2_list2"  onchange="updateData(value)">
                <option value="1">Select 2 Variables</option>
            </select>
        </div>
        <div>
            <label>Plot 3 Variables</label>
            <input id="plot3" type="radio" name="enable"  onclick="updateplot3()">
            <select name="plot3_list1" id="plot3_list1"  onchange="updateData(value)">
                <option value="1">Select 3 Variables</option>
            </select>
            <select name="plot3_list2" id="plot3_list2"  onchange="updateData(value)">
                <option value="1">Select 3 Variables</option>
            </select>
            <select name="plot3_list3" id="plot3_list3"  onchange="updateData(value)">
                <option value="1">Select 3 Variables</option>
            </select>
        </div>
        <div data-role="main" class="ui-content">
                <div data-role="rangeslider">
                    <label for="time-min">Time</label>
                    <input type="range" name="time-min" id="time-min" value="1" min="1" max="200" onchange="updateData(value)">
                    <label for="time-max">Time</label>
                    <input type="range" name="time-max" id="time-max" value="10" min="1" max="200" onchange="updateData(value)">
                </div>
        </div>
	</div>
    <div style="width: 100%; overflow: hidden;">
    <div id="wrap" style="width: 600px; float: left;"></div>
    <div id="container" style="margin-left: 620px;"></div>
    </div>
	<script src="lib/d3.min.js"></script>
	<script src="lib/papaparse.min.js"></script>
    <script src="lib/numeric-1.2.6.min.js"></script>
    <script src="lib/utils.js"></script>
    <script src="lib/three.js"></script>
    <script src="lib/TrackballControls.js"></script>
    <script src="lib/CSS3DRenderer.js"></script>
    <script src="lib/PDBLoader.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script>
        var filename ="COLVAR.csv";
        var scope = this;
        var loader = new THREE.XHRLoader( scope.manager );
        loader.load( filename, function ( text ) {
            var top = text.split( "\n" )[0].split(",");
            makeOptions("plot1_list");
            makeOptions("plot2_list1");
            makeOptions("plot2_list2");
            makeOptions("plot3_list1");
            makeOptions("plot3_list2");
            makeOptions("plot3_list3");
            function makeOptions(listname) {
                var select = document.getElementById(listname);
            for (i=0;i<top.length;i++) {
                var el = document.createElement("option");
                el.textContent=top[i];
                el.value= i+1;
                select.appendChild(el);
            }}
        });
        var headlen = document.getElementById("plot1_list");
        var len = headlen.options.length;
        var state_test = Array.apply(null, Array(len)).map(Number.prototype.valueOf,0);
        console.log(len);
        var state = [1,0,0,0,0,0,0,0,0,0,0,0,0]; // Default only first variable selected
        var t0 = $("#time-min").val();
        var t1 = $("#time-max").val();
        d3.csv(filename, function(data){
            var select = document.getElementById("plot1_list");
            var newdata=[];
            for (i=0;i<select.options.length;i++){
                newdata.push(data[select.options[i].textContent]);
            }
            return newdata;
        }, function(error, rows) {
            var length=rows[0].length;
            var xrows=[];

            for (i= t0-1;i<t1;i++) {
                var yo=[];
                for (k=0;k<length;k++) {
                    if (rows[i][k] != undefined)
                    {yo.push(rows[i][k]);}
                }
                yo.push(i);
                xrows.push(yo);
            }
            plotd3(MDScalculate(xrows,state),xrows,state);
        });
	</script>
    <div>
        <label>Colors</label>
        <select name="element_color" id="element_color">
            <option value="o">Select an Element</option>
        </select>
        <select name="color_list" id="color_list" onchange="recolor()">
            <option value="128,0,0">Maroon</option>
            <option value="255,0,0">Red</option>
            <option value="255,165,0">Orange</option>
            <option value="255,255,0">Yellow</option>
            <option value="128,128,0">Olive</option>
            <option value="0,128,0">Green</option>
            <option value="128,0,128">Purple</option>
            <option value="255,0,255">Fuschia</option>
            <option value="0,255,0">Lime</option>
            <option value="0,128,128">Teal</option>
            <option value="0,255,255">Aqua</option>
            <option value="0,0,255">Blue</option>
            <option value="0,0,128">Navy</option>
            <option value="0,0,0">Black</option>
            <option value="128,128,128">Gray</option>
            <option value="192,192,192">Silver</option>
            <option value="255,255,255">White</option>
        </select>
    </div>

    <script>
        var camera, scene, renderer;
        var controls;
        var root;

        var objects = [];
        var tmpVec1 = new THREE.Vector3();
        var tmpVec2 = new THREE.Vector3();
        var tmpVec3 = new THREE.Vector3();
        var tmpVec4 = new THREE.Vector3();
        var atomlist ={};
        var visualizationType = 0; // shows atoms only
        var framenum=1;
        var loader = {};
        var trajectory="lib/trajout.gro"

        var colorSpriteMap = {};
        var baseSprite = {};
        var CPK = { "h": [ 255,255,255 ], "k": [ 0,128,128 ], "o": [ 255,0,0 ], "at": [ 128,128,0 ], "si": [ 0,128,128 ] };


        init(framenum);
        animate();


    </script>
	</body>
</html>
